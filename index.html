<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IoT Drum Jacket Heater - Smart Control System</title>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/three@0.150.1/build/three.min.js"></script>
    <script src="https://unpkg.com/@react-three/fiber@8.13.0/dist/index.js"></script>
    <script src="https://unpkg.com/@react-three/drei@9.80.0/dist/index.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(
          135deg,
          #0f2027 0%,
          #203a43 50%,
          #2c5364 100%
        );
        overflow: hidden;
        color: #fff;
      }

      #root {
        width: 100vw;
        height: 100vh;
        position: relative;
      }

      .hud-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 10;
      }

      .hud-container {
        position: absolute;
        background: rgba(15, 32, 39, 0.92);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 20px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        pointer-events: all;
      }

      .control-panel {
        top: 20px;
        left: 20px;
        width: 320px;
      }

      .stats-panel {
        top: 20px;
        right: 20px;
        width: 300px;
      }

      .graph-panel {
        bottom: 20px;
        left: 20px;
        width: 450px;
        height: 220px;
      }

      .alerts-panel {
        bottom: 20px;
        right: 20px;
        width: 280px;
        max-height: 220px;
        overflow-y: auto;
      }

      .panel-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .panel-title {
        font-size: 16px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        animation: pulse 2s infinite;
      }

      .status-online {
        background: #4caf50;
      }
      .status-offline {
        background: #f44336;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      .metric-card {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        padding: 12px;
        margin-bottom: 12px;
        border: 1px solid rgba(255, 255, 255, 0.08);
      }

      .metric-label {
        font-size: 12px;
        color: rgba(255, 255, 255, 0.6);
        margin-bottom: 5px;
      }

      .metric-value {
        font-size: 24px;
        font-weight: 700;
        display: flex;
        align-items: baseline;
        gap: 5px;
      }

      .metric-unit {
        font-size: 14px;
        color: rgba(255, 255, 255, 0.7);
      }

      .metric-trend {
        font-size: 12px;
        margin-top: 5px;
      }

      .trend-up {
        color: #4caf50;
      }
      .trend-down {
        color: #2196f3;
      }

      .control-group {
        margin-bottom: 15px;
      }

      .control-label {
        font-size: 13px;
        margin-bottom: 8px;
        color: rgba(255, 255, 255, 0.8);
      }

      .toggle-switch {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        padding: 10px 12px;
        margin-bottom: 8px;
        cursor: pointer;
        transition: all 0.3s;
        border: 1px solid rgba(255, 255, 255, 0.08);
      }

      .toggle-switch:hover {
        background: rgba(255, 255, 255, 0.08);
      }

      .switch {
        width: 44px;
        height: 24px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 12px;
        position: relative;
        transition: all 0.3s;
      }

      .switch.active {
        background: #4caf50;
      }

      .switch-handle {
        width: 20px;
        height: 20px;
        background: white;
        border-radius: 50%;
        position: absolute;
        top: 2px;
        left: 2px;
        transition: all 0.3s;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .switch.active .switch-handle {
        left: 22px;
      }

      .slider-container {
        margin-top: 8px;
      }

      .slider {
        width: 100%;
        height: 6px;
        border-radius: 3px;
        background: rgba(255, 255, 255, 0.1);
        outline: none;
        -webkit-appearance: none;
      }

      .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #4caf50;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .slider::-moz-range-thumb {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #4caf50;
        cursor: pointer;
        border: none;
      }

      .slider-value {
        display: flex;
        justify-content: space-between;
        font-size: 11px;
        color: rgba(255, 255, 255, 0.5);
        margin-top: 5px;
      }

      .btn {
        width: 100%;
        padding: 12px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        margin-top: 8px;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
      }

      .btn-danger {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
      }

      .btn-danger:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(245, 87, 108, 0.4);
      }

      .chart-container {
        height: 140px;
        position: relative;
      }

      .alert-item {
        background: rgba(255, 255, 255, 0.05);
        border-left: 3px solid;
        padding: 10px;
        margin-bottom: 8px;
        border-radius: 4px;
        font-size: 12px;
      }

      .alert-warning {
        border-left-color: #ff9800;
      }
      .alert-error {
        border-left-color: #f44336;
      }
      .alert-info {
        border-left-color: #2196f3;
      }
      .alert-success {
        border-left-color: #4caf50;
      }

      .alert-time {
        color: rgba(255, 255, 255, 0.5);
        font-size: 10px;
        margin-top: 4px;
      }

      canvas {
        display: block;
        width: 100%;
        height: 100%;
      }

      .loading {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 18px;
        color: rgba(255, 255, 255, 0.8);
      }

      ::-webkit-scrollbar {
        width: 6px;
      }

      ::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 3px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.3);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { Canvas, useFrame, useThree } = window.ReactThreeFiber;
      const { OrbitControls, PerspectiveCamera, Environment } = window.drei;
      const { motion, AnimatePresence } = window.Motion;
      const { useState, useEffect, useRef, useMemo } = React;

      // Drum Heater 3D Component
      function DrumHeater({ isHeating, temperature, power }) {
        const drumRef = useRef();
        const heatingElementsRef = useRef();
        const lightsRef = useRef();

        useFrame((state) => {
          if (drumRef.current) {
            // Subtle rotation
            drumRef.current.rotation.y += 0.001;
          }

          if (heatingElementsRef.current && isHeating) {
            // Heating animation
            const intensity = 0.3 + Math.sin(state.clock.elapsedTime * 2) * 0.2;
            heatingElementsRef.current.children.forEach((child, i) => {
              if (child.material) {
                child.material.emissiveIntensity = intensity;
              }
            });
          }

          // Animate indicator lights
          if (lightsRef.current) {
            lightsRef.current.children[0].material.emissiveIntensity =
              0.5 + Math.sin(state.clock.elapsedTime * 2) * 0.3;
            lightsRef.current.children[1].material.emissiveIntensity =
              0.5 + Math.sin(state.clock.elapsedTime * 2 + Math.PI) * 0.3;
          }
        });

        // Color based on temperature
        const drumColor = useMemo(() => {
          if (temperature > 150) return "#ff6b6b";
          if (temperature > 100) return "#ffa94d";
          return "#aaaaaa";
        }, [temperature]);

        return (
          <group ref={drumRef}>
            {/* Base with wheels */}
            <mesh position={[0, 0, 0]} castShadow receiveShadow>
              <boxGeometry args={[2.2, 0.15, 2.2]} />
              <meshStandardMaterial
                color="#888888"
                metalness={0.7}
                roughness={0.3}
              />
            </mesh>

            {/* Wheels */}
            {[
              [-0.85, -0.08, 0.85],
              [0.85, -0.08, 0.85],
              [-0.85, -0.08, -0.85],
              [0.85, -0.08, -0.85],
            ].map((pos, i) => (
              <mesh
                key={i}
                position={pos}
                rotation={[0, 0, Math.PI / 2]}
                castShadow>
                <cylinderGeometry args={[0.08, 0.08, 0.06, 16]} />
                <meshStandardMaterial
                  color="#333333"
                  metalness={0.6}
                  roughness={0.4}
                />
              </mesh>
            ))}

            {/* Main drum */}
            <mesh position={[0, 1.5, 0]} castShadow receiveShadow>
              <cylinderGeometry args={[1, 1, 2.5, 32]} />
              <meshStandardMaterial
                color={drumColor}
                metalness={0.7}
                roughness={0.3}
                emissive={isHeating ? "#ff4400" : "#000000"}
                emissiveIntensity={isHeating ? 0.2 : 0}
              />
            </mesh>

            {/* Inner drum */}
            <mesh position={[0, 1.5, 0]}>
              <cylinderGeometry args={[0.88, 0.88, 2.4, 32]} />
              <meshStandardMaterial
                color="#666666"
                metalness={0.5}
                roughness={0.6}
                side={THREE.DoubleSide}
              />
            </mesh>

            {/* Top rim */}
            <mesh
              position={[0, 2.75, 0]}
              rotation={[Math.PI / 2, 0, 0]}
              castShadow>
              <torusGeometry args={[1, 0.08, 16, 32]} />
              <meshStandardMaterial
                color="#ffffff"
                metalness={0.8}
                roughness={0.2}
              />
            </mesh>

            {/* Heating elements */}
            <group ref={heatingElementsRef}>
              {Array.from({ length: 24 }).map((_, i) => {
                const angle = (i / 24) * Math.PI * 2;
                const x = Math.cos(angle) * 0.87;
                const z = Math.sin(angle) * 0.87;
                return (
                  <mesh key={i} position={[x, 1.5, z]} rotation={[0, angle, 0]}>
                    <boxGeometry args={[0.04, 2.0, 0.03]} />
                    <meshStandardMaterial
                      color="#222222"
                      metalness={0.7}
                      roughness={0.3}
                      emissive={isHeating ? "#ff3300" : "#330000"}
                      emissiveIntensity={isHeating ? 0.5 : 0.1}
                    />
                  </mesh>
                );
              })}
            </group>

            {/* Control panel box */}
            <mesh position={[-1.4, 1.8, 0]} castShadow>
              <boxGeometry args={[0.6, 1.2, 0.15]} />
              <meshStandardMaterial
                color="#dddddd"
                metalness={0.5}
                roughness={0.4}
              />
            </mesh>

            {/* Digital display */}
            <mesh position={[-1.48, 2.2, 0]}>
              <boxGeometry args={[0.35, 0.2, 0.02]} />
              <meshStandardMaterial
                color="#1a1a1a"
                emissive="#00ff00"
                emissiveIntensity={0.5}
              />
            </mesh>

            {/* Indicator lights */}
            <group ref={lightsRef}>
              <mesh position={[-1.48, 1.7, -0.1]}>
                <circleGeometry args={[0.04, 16]} />
                <meshStandardMaterial
                  color="#ff0000"
                  emissive="#ff0000"
                  emissiveIntensity={isHeating ? 0.8 : 0.2}
                />
              </mesh>
              <mesh position={[-1.48, 1.7, 0.1]}>
                <circleGeometry args={[0.04, 16]} />
                <meshStandardMaterial
                  color="#00ff00"
                  emissive="#00ff00"
                  emissiveIntensity={power ? 0.8 : 0.2}
                />
              </mesh>
            </group>

            {/* Emergency stop button */}
            <mesh position={[-1.48, 1.35, 0]} rotation={[0, 0, Math.PI / 2]}>
              <cylinderGeometry args={[0.1, 0.1, 0.05, 16]} />
              <meshStandardMaterial
                color="#ff0000"
                metalness={0.3}
                roughness={0.4}
              />
            </mesh>

            {/* Yellow warning frame */}
            <mesh position={[-1.47, 1.35, 0]}>
              <boxGeometry args={[0.22, 0.22, 0.02]} />
              <meshStandardMaterial
                color="#ffeb3b"
                metalness={0.3}
                roughness={0.5}
              />
            </mesh>

            {/* Rotary knob */}
            <mesh position={[-1.48, 1.5, 0.2]} rotation={[0, 0, Math.PI / 2]}>
              <cylinderGeometry args={[0.06, 0.06, 0.04, 16]} />
              <meshStandardMaterial
                color="#444444"
                metalness={0.8}
                roughness={0.2}
              />
            </mesh>

            {/* Side panel */}
            <mesh position={[-1.15, 1.5, 0]} castShadow>
              <boxGeometry args={[0.5, 2.0, 0.08]} />
              <meshStandardMaterial
                color="#dddddd"
                metalness={0.5}
                roughness={0.4}
              />
            </mesh>

            {/* Connection ports */}
            <mesh position={[1.1, 1.8, 0.3]} rotation={[0, 0, Math.PI / 2]}>
              <cylinderGeometry args={[0.08, 0.08, 0.15, 16]} />
              <meshStandardMaterial
                color="#666666"
                metalness={0.7}
                roughness={0.3}
              />
            </mesh>
            <mesh position={[1.1, 1.2, 0.3]} rotation={[0, 0, Math.PI / 2]}>
              <cylinderGeometry args={[0.08, 0.08, 0.15, 16]} />
              <meshStandardMaterial
                color="#666666"
                metalness={0.7}
                roughness={0.3}
              />
            </mesh>

            {/* Cable conduit */}
            <mesh position={[-0.3, 2.9, 0.3]}>
              <cylinderGeometry args={[0.05, 0.05, 0.3, 8]} />
              <meshStandardMaterial
                color="#444444"
                metalness={0.8}
                roughness={0.2}
              />
            </mesh>
          </group>
        );
      }

      // Scene Component
      function Scene({ isHeating, temperature, power }) {
        return (
          <>
            <PerspectiveCamera makeDefault position={[5, 4, 8]} fov={45} />
            <OrbitControls
              enableDamping
              dampingFactor={0.05}
              minDistance={3}
              maxDistance={15}
              maxPolarAngle={Math.PI / 2}
            />

            <ambientLight intensity={0.6} />
            <directionalLight
              position={[5, 10, 7]}
              intensity={0.8}
              castShadow
              shadow-mapSize-width={2048}
              shadow-mapSize-height={2048}
            />
            <directionalLight position={[-5, 5, -5]} intensity={0.3} />
            <pointLight position={[0, 3, -5]} intensity={0.4} />

            <DrumHeater
              isHeating={isHeating}
              temperature={temperature}
              power={power}
            />

            {/* Ground */}
            <mesh
              rotation={[-Math.PI / 2, 0, 0]}
              position={[0, -0.5, 0]}
              receiveShadow>
              <planeGeometry args={[20, 20]} />
              <meshStandardMaterial
                color="#cccccc"
                roughness={0.8}
                metalness={0.2}
              />
            </mesh>

            <Environment preset="warehouse" />
            <fog attach="fog" args={["#f0f0f0", 10, 50]} />
          </>
        );
      }

      // IoT Control Panel Component
      function ControlPanel({ state, setState }) {
        return (
          <motion.div
            className="hud-container control-panel"
            initial={{ opacity: 0, x: -50 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ duration: 0.5 }}>
            <div className="panel-header">
              <div className="panel-title">‚öôÔ∏è Control Panel</div>
              <div
                className={`status-dot ${
                  state.online ? "status-online" : "status-offline"
                }`}
              />
            </div>

            <div className="control-group">
              <div
                className="toggle-switch"
                onClick={() => setState((s) => ({ ...s, power: !s.power }))}>
                <span>Power</span>
                <div className={`switch ${state.power ? "active" : ""}`}>
                  <div className="switch-handle" />
                </div>
              </div>

              <div
                className="toggle-switch"
                onClick={() =>
                  setState((s) => ({ ...s, heating: !s.heating }))
                }>
                <span>Heating</span>
                <div className={`switch ${state.heating ? "active" : ""}`}>
                  <div className="switch-handle" />
                </div>
              </div>

              <div
                className="toggle-switch"
                onClick={() =>
                  setState((s) => ({ ...s, autoMode: !s.autoMode }))
                }>
                <span>Auto Mode</span>
                <div className={`switch ${state.autoMode ? "active" : ""}`}>
                  <div className="switch-handle" />
                </div>
              </div>
            </div>

            <div className="control-group">
              <div className="control-label">Target Temperature</div>
              <div className="slider-container">
                <input
                  type="range"
                  className="slider"
                  min="20"
                  max="200"
                  value={state.targetTemp}
                  onChange={(e) =>
                    setState((s) => ({
                      ...s,
                      targetTemp: parseInt(e.target.value),
                    }))
                  }
                />
                <div className="slider-value">
                  <span>20¬∞C</span>
                  <span
                    style={{
                      color: "#4caf50",
                      fontSize: "14px",
                      fontWeight: "bold",
                    }}>
                    {state.targetTemp}¬∞C
                  </span>
                  <span>200¬∞C</span>
                </div>
              </div>
            </div>

            <div className="control-group">
              <div className="control-label">Power Level</div>
              <div className="slider-container">
                <input
                  type="range"
                  className="slider"
                  min="0"
                  max="100"
                  value={state.powerLevel}
                  onChange={(e) =>
                    setState((s) => ({
                      ...s,
                      powerLevel: parseInt(e.target.value),
                    }))
                  }
                />
                <div className="slider-value">
                  <span>0%</span>
                  <span
                    style={{
                      color: "#4caf50",
                      fontSize: "14px",
                      fontWeight: "bold",
                    }}>
                    {state.powerLevel}%
                  </span>
                  <span>100%</span>
                </div>
              </div>
            </div>

            <button
              className="btn btn-primary"
              onClick={() =>
                setState((s) => ({
                  ...s,
                  heating: true,
                  power: true,
                }))
              }>
              üî• Start Heating
            </button>
            <button
              className="btn btn-danger"
              onClick={() =>
                setState((s) => ({
                  ...s,
                  heating: false,
                  power: false,
                }))
              }>
              üõë Emergency Stop
            </button>
          </motion.div>
        );
      }

      // Stats Panel Component
      function StatsPanel({ state }) {
        return (
          <motion.div
            className="hud-container stats-panel"
            initial={{ opacity: 0, x: 50 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ duration: 0.5, delay: 0.1 }}>
            <div className="panel-header">
              <div className="panel-title">üìä Live Metrics</div>
            </div>

            <div className="metric-card">
              <div className="metric-label">Current Temperature</div>
              <div className="metric-value">
                <span>{state.temperature.toFixed(1)}</span>
                <span className="metric-unit">¬∞C</span>
              </div>
              <div className="metric-trend trend-up">
                ‚Üë {state.tempChange > 0 ? "+" : ""}
                {state.tempChange.toFixed(1)}¬∞C/min
              </div>
            </div>

            <div className="metric-card">
              <div className="metric-label">Power Consumption</div>
              <div className="metric-value">
                <span>{(state.powerLevel * 0.15).toFixed(2)}</span>
                <span className="metric-unit">kW</span>
              </div>
              <div className="metric-trend" style={{ color: "#ff9800" }}>
                {state.powerLevel}% Load
              </div>
            </div>

            <div className="metric-card">
              <div className="metric-label">Runtime</div>
              <div className="metric-value">
                <span>
                  {Math.floor(state.runtime / 60)}h {state.runtime % 60}m
                </span>
              </div>
              <div className="metric-trend" style={{ color: "#2196f3" }}>
                Efficiency: {(85 + Math.random() * 10).toFixed(1)}%
              </div>
            </div>

            <div className="metric-card">
              <div className="metric-label">System Status</div>
              <div style={{ fontSize: "14px", marginTop: "5px" }}>
                <div>üîå {state.online ? "Online" : "Offline"}</div>
                <div>üî• {state.heating ? "Heating Active" : "Standby"}</div>
                <div>ü§ñ {state.autoMode ? "Auto Mode" : "Manual"}</div>
              </div>
            </div>
          </motion.div>
        );
      }

      // Temperature Graph Component
      function TemperatureGraph({ history }) {
        const canvasRef = useRef();

        useEffect(() => {
          const canvas = canvasRef.current;
          if (!canvas) return;

          const ctx = canvas.getContext("2d");
          const width = canvas.width;
          const height = canvas.height;

          // Clear canvas
          ctx.fillStyle = "rgba(255, 255, 255, 0.02)";
          ctx.fillRect(0, 0, width, height);

          // Draw grid
          ctx.strokeStyle = "rgba(255, 255, 255, 0.1)";
          ctx.lineWidth = 1;
          for (let i = 0; i <= 5; i++) {
            const y = (height / 5) * i;
            ctx.beginPath();
            ctx.moveTo(0, y);
            ctx.lineTo(width, y);
            ctx.stroke();
          }

          // Draw temperature line
          if (history.length > 1) {
            const maxTemp = Math.max(...history.map((h) => h.temp));
            const minTemp = Math.min(...history.map((h) => h.temp));
            const tempRange = maxTemp - minTemp || 1;

            ctx.strokeStyle = "#4caf50";
            ctx.lineWidth = 2;
            ctx.beginPath();

            history.forEach((point, i) => {
              const x = (i / (history.length - 1)) * width;
              const y =
                height -
                ((point.temp - minTemp) / tempRange) * height * 0.9 -
                height * 0.05;

              if (i === 0) {
                ctx.moveTo(x, y);
              } else {
                ctx.lineTo(x, y);
              }
            });

            ctx.stroke();

            // Draw gradient fill
            const gradient = ctx.createLinearGradient(0, 0, 0, height);
            gradient.addColorStop(0, "rgba(76, 175, 80, 0.3)");
            gradient.addColorStop(1, "rgba(76, 175, 80, 0)");

            ctx.fillStyle = gradient;
            ctx.lineTo(width, height);
            ctx.lineTo(0, height);
            ctx.closePath();
            ctx.fill();
          }

          // Draw labels
          ctx.fillStyle = "rgba(255, 255, 255, 0.6)";
          ctx.font = "10px monospace";
          ctx.fillText(
            `${history[history.length - 1]?.temp.toFixed(1)}¬∞C`,
            width - 50,
            15
          );
        }, [history]);

        return (
          <motion.div
            className="hud-container graph-panel"
            initial={{ opacity: 0, y: 50 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.5, delay: 0.2 }}>
            <div className="panel-header">
              <div className="panel-title">üìà Temperature History</div>
            </div>
            <div className="chart-container">
              <canvas
                ref={canvasRef}
                width={410}
                height={140}
                style={{ width: "100%", height: "100%" }}
              />
            </div>
          </motion.div>
        );
      }

      // Alerts Panel Component
      function AlertsPanel({ alerts }) {
        return (
          <motion.div
            className="hud-container alerts-panel"
            initial={{ opacity: 0, y: 50 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.5, delay: 0.3 }}>
            <div className="panel-header">
              <div className="panel-title">üîî System Alerts</div>
            </div>
            <div>
              <AnimatePresence>
                {alerts.map((alert, i) => (
                  <motion.div
                    key={alert.id}
                    className={`alert-item alert-${alert.type}`}
                    initial={{ opacity: 0, x: 20 }}
                    animate={{ opacity: 1, x: 0 }}
                    exit={{ opacity: 0, x: -20 }}
                    transition={{ duration: 0.3 }}>
                    {alert.message}
                    <div className="alert-time">{alert.time}</div>
                  </motion.div>
                ))}
              </AnimatePresence>
            </div>
          </motion.div>
        );
      }

      // Main App Component
      function App() {
        const [state, setState] = useState({
          power: false,
          heating: false,
          autoMode: false,
          temperature: 25,
          targetTemp: 100,
          powerLevel: 50,
          runtime: 0,
          tempChange: 0,
          online: true,
        });

        const [tempHistory, setTempHistory] = useState([{ time: 0, temp: 25 }]);
        const [alerts, setAlerts] = useState([
          {
            id: 1,
            type: "success",
            message: "System initialized successfully",
            time: "Just now",
          },
          {
            id: 2,
            type: "info",
            message: "Connected to IoT cloud",
            time: "1 min ago",
          },
        ]);

        // Simulation loop
        useEffect(() => {
          const interval = setInterval(() => {
            setState((prevState) => {
              let newTemp = prevState.temperature;
              const diff = prevState.targetTemp - prevState.temperature;

              if (prevState.heating && prevState.power) {
                // Heat up
                newTemp += (prevState.powerLevel / 100) * 0.5;
              } else {
                // Cool down
                if (newTemp > 25) {
                  newTemp -= 0.2;
                }
              }

              // Auto mode logic
              let heating = prevState.heating;
              if (prevState.autoMode && prevState.power) {
                if (newTemp < prevState.targetTemp - 5) {
                  heating = true;
                } else if (newTemp > prevState.targetTemp) {
                  heating = false;
                }
              }

              const tempChange = (newTemp - prevState.temperature) * 60;

              return {
                ...prevState,
                temperature: Math.max(25, Math.min(200, newTemp)),
                heating,
                tempChange,
                runtime: prevState.power
                  ? prevState.runtime + 1
                  : prevState.runtime,
              };
            });
          }, 1000);

          return () => clearInterval(interval);
        }, []);

        // Update temperature history
        useEffect(() => {
          const interval = setInterval(() => {
            setTempHistory((prev) => {
              const newHistory = [
                ...prev,
                {
                  time: prev.length,
                  temp: state.temperature,
                },
              ];
              return newHistory.slice(-60); // Keep last 60 points
            });
          }, 1000);

          return () => clearInterval(interval);
        }, [state.temperature]);

        // Alert system
        useEffect(() => {
          if (state.temperature > state.targetTemp + 10) {
            const newAlert = {
              id: Date.now(),
              type: "warning",
              message: `Temperature exceeded target by ${(
                state.temperature - state.targetTemp
              ).toFixed(1)}¬∞C`,
              time: "Just now",
            };
            setAlerts((prev) => [newAlert, ...prev].slice(0, 5));
          }

          if (state.temperature > 180) {
            const newAlert = {
              id: Date.now(),
              type: "error",
              message: "Critical: Temperature approaching maximum limit!",
              time: "Just now",
            };
            setAlerts((prev) => [newAlert, ...prev].slice(0, 5));
          }

          if (state.heating && !state.power) {
            const newAlert = {
              id: Date.now(),
              type: "warning",
              message: "Heating requested but power is off",
              time: "Just now",
            };
            setAlerts((prev) => [newAlert, ...prev].slice(0, 5));
          }
        }, [state.temperature, state.targetTemp, state.heating, state.power]);

        return (
          <>
            <Canvas shadows>
              <Scene
                isHeating={state.heating && state.power}
                temperature={state.temperature}
                power={state.power}
              />
            </Canvas>

            <div className="hud-overlay">
              <ControlPanel state={state} setState={setState} />
              <StatsPanel state={state} />
              <TemperatureGraph history={tempHistory} />
              <AlertsPanel alerts={alerts} />
            </div>
          </>
        );
      }

      // Render the app
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
